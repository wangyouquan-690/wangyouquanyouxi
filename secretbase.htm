<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>秘密基地</title>
    <style>
        * {margin: 0;padding: 0;box-sizing: border-box;}
        body {background-color: #f0f0f0;}
        .container {width: 1280px;height: 720px;margin: 0 auto;background-image: url("D:/忘忧泉小程序实验室/秘密基地背景.jpg");background-size: cover;position: relative;}
        .header {position: absolute;top: 20px;left: 20px;right: 20px;display: flex;justify-content: space-between;align-items: center;color: #fff;}
        .back-btn {width: 120px;height: 40px;background-color: #007bff;border: none;border-radius: 8px;color: #fff;font-size: 16px;cursor: pointer;}
        .back-btn:hover {background-color: #0056b3;}
        
        /* 属性提示栏 */
        .attr-panel {position: absolute;top: 80px;left: 50px;width: 250px;background-color: rgba(0,0,0,0.7);border-radius: 10px;padding: 15px;color: #fff;}
        .attr-title {font-size: 18px;font-weight: bold;margin-bottom: 10px;}
        .attr-item {font-size: 14px;margin: 5px 0;}
        
        /* 黑板区域 */
        .blackboard {position: absolute;top: 80px;right: 50px;width: 300px;height: 400px;background-color: #222;border: 5px solid #666;border-radius: 5px;padding: 20px;}
        .blackboard-title {font-size: 18px;color: #fff;text-align: center;margin-bottom: 15px;}
        .resident-list {font-size: 16px;color: #fff;line-height: 2;}
        /* 妹妹立绘容器（默认隐藏，邀请后显示） */
        .sister-avatar-wrap {margin-top: 20px;padding-top: 15px;border-top: 1px dashed #666;display: none;}
        .sister-avatar {width: 150px;height: auto;border-radius: 8px;box-shadow: 0 0 10px rgba(255,255,255,0.3);}
        .sister-info {color: #fff;margin-top: 5px;font-size: 14px;}
        .intimacy-progress {width: 100%;height: 8px;background-color: #444;border-radius: 4px;margin: 5px 0;overflow: hidden;}
        .intimacy-bar {height: 100%;background-color: #ffeb3b;width: 0%;transition: width 0.5s;}
        .intimacy-tip {font-size: 12px;color: #999;margin-top: 3px;}
        
        /* 邀请选项 */
        .invite-panel {position: absolute;bottom: 50px;left: 50%;transform: translateX(-50%);display: flex;gap: 30px;}
        .invite-option {width: 120px;height: 120px;border-radius: 50%;background-color: rgba(255,255,255,0.2);display: flex;flex-direction: column;align-items: center;justify-content: center;cursor: pointer;transition: all 0.3s;}
        .invite-option:hover {background-color: rgba(255,255,255,0.4);transform: scale(1.05);}
        .invite-icon {width: 60px;height: 60px;margin-bottom: 10px;}
        .invite-name {font-size: 14px;color: #fff;}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>我的秘密基地</h1>
            <button class="back-btn" onclick="window.location.href='A现代养成游戏-我是“权”能王主界面.htm'">返回主界面</button>
        </div>
        <!-- 属性提示栏 -->
        <div class="attr-panel">
            <div class="attr-title">当前属性</div>
            <div class="attr-item">编程：<span id="programming">120</span></div>
            <div class="attr-item">口才：<span id="eloquence">150</span></div>
            <div class="attr-item">医术：<span id="medical">90</span></div>
            <div class="attr-item">体能：<span id="physical">180</span></div>
            <div class="attr-item">灵感：<span id="inspiration">230</span></div>
            <div class="attr-item">人气：<span id="popularity">2634</span></div>
        </div>
        <!-- 黑板（入住列表） -->
        <div class="blackboard">
            <div class="blackboard-title">已入住成员</div>
            <div class="resident-list" id="residentList">
                暂无成员，邀请TA们进来吧~
            </div>
            <!-- 妹妹立绘容器（邀请后显示） -->
            <div class="sister-avatar-wrap" id="sisterAvatarWrap">
                <img src="妹妹-立绘.png" alt="妹妹" class="sister-avatar">
                <div class="sister-info">妹妹（亲密度：<span id="sisterIntimacy">0</span>）</div>
                <div class="intimacy-progress">
                    <div class="intimacy-bar" id="intimacyBar"></div>
                </div>
                <div class="intimacy-tip" id="intimacyTip">亲密度≥50解锁专属剧情</div>
            </div>
        </div>
        <!-- 邀请选项 -->
        <div class="invite-panel">
            <div class="invite-option" onclick="invite('妹妹')">
                <div class="invite-icon">
                    <svg viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="30" cy="15" r="10" fill="#fff"/>
                        <path d="M25 25L35 25" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M20 35L40 35" stroke="#fff" stroke-width="3" stroke-linecap="round"/>
                    </svg>
                </div>
                <div class="invite-name">邀请妹妹</div>
            </div>
            <div class="invite-option" onclick="invite('宠物')">
                <div class="invite-icon">
                    <svg viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="30" cy="20" r="10" fill="#fff"/>
                        <path d="M20 30L40 30" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M15 40L25 50L35 45L45 50" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
                <div class="invite-name">邀请宠物</div>
            </div>
        </div>
    </div>
    <script>
        // 统一存储键名
        const STORAGE_KEYS = {
            CHARACTER: 'characterAttrs',
            RESIDENTS: 'secretBaseResidents',
            SISTER_INTIMACY: 'sisterIntimacy'
        };

        // 初始化数据
        let characterAttrs = JSON.parse(localStorage.getItem(STORAGE_KEYS.CHARACTER)) || {
            programming: 120, eloquence: 150, medical: 90, physical: 180, inspiration: 230, popularity: 2634
        };
        let residents = JSON.parse(localStorage.getItem(STORAGE_KEYS.RESIDENTS)) || [];
        let sisterIntimacy = parseInt(localStorage.getItem(STORAGE_KEYS.SISTER_INTIMACY)) || 0;

        // 页面加载初始化
        window.onload = function() {
            // 渲染属性
            renderCharacterAttrs();
            // 渲染入住列表
            updateResidentList();
            // 检查妹妹是否已入住，若已入住则显示立绘
            if (residents.includes('妹妹')) {
                showSisterAvatar();
            }
        };

        // 渲染主角属性
        function renderCharacterAttrs() {
            document.getElementById('programming').innerText = characterAttrs.programming;
            document.getElementById('eloquence').innerText = characterAttrs.eloquence;
            document.getElementById('medical').innerText = characterAttrs.medical;
            document.getElementById('physical').innerText = characterAttrs.physical;
            document.getElementById('inspiration').innerText = characterAttrs.inspiration;
            document.getElementById('popularity').innerText = characterAttrs.popularity;
        }

        // 邀请成员
        function invite(name) {
            if (residents.includes(name)) {
                alert(`${name}已经在秘密基地啦~`);
                return;
            }
            // 添加到入住列表
            residents.push(name);
            localStorage.setItem(STORAGE_KEYS.RESIDENTS, JSON.stringify(residents));
            // 更新列表显示
            updateResidentList();
            alert(`成功邀请${name}入住秘密基地！`);
            
            // 若邀请的是妹妹，显示立绘
            if (name === '妹妹') {
                showSisterAvatar();
            }
        }

        // 显示妹妹立绘
        function showSisterAvatar() {
            const avatarWrap = document.getElementById('sisterAvatarWrap');
            avatarWrap.style.display = 'block';
            // 更新亲密度显示
            updateSisterIntimacy();
        }

        // 更新入住列表
        function updateResidentList() {
            const listElem = document.getElementById('residentList');
            if (residents.length === 0) {
                listElem.innerText = '暂无成员，邀请TA们进来吧~';
            } else {
                listElem.innerHTML = residents.map(item => `• ${item} 已入住`).join('<br>');
            }
        }

        // 更新妹妹亲密度显示
        function updateSisterIntimacy() {
            document.getElementById('sisterIntimacy').innerText = sisterIntimacy;
            // 计算进度条（最大100）
            const percent = Math.min((sisterIntimacy / 100) * 100, 100);
            document.getElementById('intimacyBar').style.width = `${percent}%`;
            // 亲密度≥50时更新提示
            if (sisterIntimacy >= 50) {
                document.getElementById('intimacyTip').innerText = '亲密度已满50！解锁专属剧情';
                document.getElementById('intimacyTip').style.color = '#ffeb3b';
            }
        }
    </script>
</body>
</html>